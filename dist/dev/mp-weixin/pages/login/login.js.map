{"version":3,"file":"login.js","sources":["../../../../../src/pages/login/login.vue","../../../../../uniPage:/cGFnZXMvbG9naW4vbG9naW4udnVl"],"sourcesContent":["<script setup lang=\"ts\">\nimport { postLoginWxMinAPI, postLoginWxMinSimpleAPI } from \"@/services/login\";\nimport { useMemberStore } from \"@/stores/modules/member\";\nimport { onLoad } from \"@dcloudio/uni-app\";\n// 获取 code 登陆凭证\n\nlet code = \"\";\nonLoad(async () => {\n  let res = await wx.login();\n  code = res.code;\n});\n\n// 获取用户手机号码（企业中）\nconst onGetphonenumber: UniHelper.ButtonOnGetphonenumber = async (ev) => {\n  // 利用感叹号❕ 进行非空断言\n  const encryptedData = ev.detail!.encryptedData!;\n  const iv = ev.detail!.iv!;\n  await postLoginWxMinAPI({\n    code,\n    encryptedData,\n    iv,\n  });\n};\n\n\n// 模拟手机号码快捷登录 (开发练习)\nconst onGetphonenumberSimple = async () => {\n  const res = await postLoginWxMinSimpleAPI(\"13123456789\");\n  // 保存会员信息\n  const memberStore = useMemberStore();\n  memberStore.setProfile(res.result);\n\n  // 页面跳转\n  // uni.switchTab({ url: \"/pages/my/my\" });\n  uni.navigateBack();\n  uni.showToast({\n    icon: \"success\",\n    title: \"登录成功\",\n  });\n};\n</script>\n\n<template>\n  <view class=\"viewport\">\n    <view class=\"logo\">\n      <image\n        src=\"https://pcapi-xiaotuxian-front-devtest.itheima.net/miniapp/images/logo_icon.png\"\n      ></image>\n    </view>\n\n    <view class=\"login\">\n      <!-- 网页端表单登录 -->\n      <!-- 仅仅只会在H5编译 -->\n\n\n\n\n\n\n      <!-- 小程序端授权登录 -->\n      <!-- 因为这个授权功能是微信小程序独有的 -->\n\n      <button\n        class=\"button phone\"\n        open-type=\"getPhoneNumber\"\n        @getphonenumber=\"onGetphonenumber\"\n      >\n        <text class=\"icon icon-phone\"></text>\n        手机号快捷登录\n      </button>\n\n\n      <view class=\"extra\">\n        <view class=\"caption\">\n          <text>其他登录方式</text>\n        </view>\n        <view class=\"options\">\n          <!-- 通用模拟登录 -->\n          <button @tap=\"onGetphonenumberSimple\">\n            <text class=\"icon icon-phone\">模拟快捷登录</text>\n          </button>\n        </view>\n      </view>\n      <view class=\"tips\"\n        >登录/注册即视为你同意《服务条款》和《小兔鲜儿隐私协议》</view\n      >\n    </view>\n  </view>\n</template>\n\n<style lang=\"scss\">\npage {\n  height: 100%;\n}\n\n.viewport {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  padding: 20rpx 40rpx;\n}\n\n.logo {\n  flex: 1;\n  text-align: center;\n  image {\n    width: 220rpx;\n    height: 220rpx;\n    margin-top: 15vh;\n  }\n}\n\n.login {\n  display: flex;\n  flex-direction: column;\n  height: 60vh;\n  padding: 40rpx 20rpx 20rpx;\n\n  .input {\n    width: 100%;\n    height: 80rpx;\n    font-size: 28rpx;\n    border-radius: 72rpx;\n    border: 1px solid #ddd;\n    padding-left: 30rpx;\n    margin-bottom: 20rpx;\n  }\n\n  .button {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    width: 100%;\n    height: 80rpx;\n    font-size: 28rpx;\n    border-radius: 72rpx;\n    color: #fff;\n    .icon {\n      font-size: 40rpx;\n      margin-right: 6rpx;\n    }\n  }\n\n  .phone {\n    background-color: #28bb9c;\n  }\n\n  .wechat {\n    background-color: #06c05f;\n  }\n\n  .extra {\n    flex: 1;\n    padding: 70rpx 70rpx 0;\n    .caption {\n      width: 440rpx;\n      line-height: 1;\n      border-top: 1rpx solid #ddd;\n      font-size: 26rpx;\n      color: #999;\n      position: relative;\n      text {\n        transform: translate(-40%);\n        background-color: #fff;\n        position: absolute;\n        top: -12rpx;\n        left: 50%;\n      }\n    }\n\n    .options {\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      margin-top: 70rpx;\n      button {\n        padding: 0;\n        background-color: transparent;\n      }\n    }\n\n    .icon {\n      font-size: 24rpx;\n      color: #444;\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n\n      &::before {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        width: 80rpx;\n        height: 80rpx;\n        margin-bottom: 6rpx;\n        font-size: 40rpx;\n        border: 1rpx solid #444;\n        border-radius: 50%;\n      }\n    }\n    .icon-weixin::before {\n      border-color: #06c05f;\n      color: #06c05f;\n    }\n  }\n}\n\n.tips {\n  position: absolute;\n  bottom: 80rpx;\n  left: 20rpx;\n  right: 20rpx;\n  font-size: 22rpx;\n  color: #999;\n  text-align: center;\n}\n</style>\n","import MiniProgramPage from '/Users/ljh/Desktop/uniapp-v3+Ts-shop/src/pages/login/login.vue'\nwx.createPage(MiniProgramPage)"],"names":["onLoad","wx","postLoginWxMinAPI","postLoginWxMinSimpleAPI","useMemberStore","uni"],"mappings":";;;;;;;;;AAMA,QAAI,OAAO;AACXA,kBAAAA,OAAO,YAAY;AACb,UAAA,MAAM,MAAMC,mBAAG;AACnB,aAAO,IAAI;AAAA,IAAA,CACZ;AAGK,UAAA,mBAAqD,OAAO,OAAO;AAEjE,YAAA,gBAAgB,GAAG,OAAQ;AAC3B,YAAA,KAAK,GAAG,OAAQ;AACtB,YAAMC,iCAAkB;AAAA,QACtB;AAAA,QACA;AAAA,QACA;AAAA,MAAA,CACD;AAAA,IAAA;AAKH,UAAM,yBAAyB,YAAY;AACnC,YAAA,MAAM,MAAMC,uCAAwB,aAAa;AAEvD,YAAM,cAAcC,sBAAAA;AACR,kBAAA,WAAW,IAAI,MAAM;AAIjCC,oBAAA,MAAI,aAAa;AACjBA,oBAAAA,MAAI,UAAU;AAAA,QACZ,MAAM;AAAA,QACN,OAAO;AAAA,MAAA,CACR;AAAA,IAAA;;;;;;;;;;ACrCH,GAAG,WAAW,eAAe;"}